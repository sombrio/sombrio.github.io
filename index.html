<!DOCTYPE html>
<html>
  <head>
    <!-- import jquery -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    
    <script>
    if (!String.format) {
      String.format = function(format) {
        var args = Array.prototype.slice.call(arguments, 1);
        return format.replace(/{(\d+)}/g, function(match, number) { 
          return typeof args[number] != 'undefined'
            ? args[number] 
            : match
          ;
        });
      };
    }
    </script>
    
    <style>
    table.topazCells {
      border: 0px solid #555555;
      background-color: #FFFFFF;
      width: 400px;
      text-align: center;
      border-collapse: collapse;
    }
    table.topazCells td, table.topazCells th {
      border: 1px solid #555555;
      padding: 4px 1px;
    }
    table.topazCells tbody td {
      font-size: 13px;
      color: #000000;
    }
    table.topazCells thead, td:nth-child(1) {
      background: #B2B2B2;
      border-bottom: 3px solid #000000;
    }
    table.topazCells thead th, td:nth-child(1) {
      font-size: 12px;
      font-weight: bold;
      color: #000000;
      text-align: center;
    }
    table.topazCells tfoot td {
      font-size: 13px;
    }
    table.topazCells tfoot .links {
      text-align: right;
    }
    table.topazCells tfoot .links a{
      display: inline-block;
      background: #FFFFFF;
      color: #A43152;
      padding: 2px 8px;
      border-radius: 5px;
    }
    </style>
    
    <script>
      var BIT0 = 0x01;
      var BIT1 = 0x02;
      var BIT2 = 0x04;
      var BIT3 = 0x08;
      var BIT4 = 0x10;
      var BIT5 = 0x20;
      var BIT6 = 0x40;
      var BIT7 = 0x80;
      
      var EDID_VERSION = '';
    </script>


    <script>
      function toHexString(byteArray, joinChar) {
        return Array.from(byteArray, function(byte) {
          return ('0' + (byte & 0xFF).toString(16)).slice(-2);
        }).join(joinChar)
      }
      
      var openFile = function (event) {
        var input = event.target;

        var reader = new FileReader();

        reader.onload = function () {
          var edidBuffer = new Uint8Array(reader.result);
          
          for (var i = 0; i < edidBuffer.length; i++) {
            $(String.format('#data{0}', i)).text(toHexString(edidBuffer.slice(i, i+1)));
          }

          // set to output
          //$("#output").text(toHexString(edidBuffer, ''));

          // core builder
          $('#out_table_head').empty();
          $('#out_table_body').empty();
          $('#out_table_head_basidDisplayParameter').empty();
          $('#out_table_body_basidDisplayParameter').empty();
          var htmlStr = '';

          // header
          htmlStr = '<tr><td>Bytes</td><td>Description</td></tr><tr><td>0-19</td><td>Header information</td></tr>';
          $('#out_table_head').append(htmlStr);

          htmlStr = abccc(edidBuffer.slice(0, 20));
          $('#out_table_body').append(htmlStr);
          
          // Basic Display Information
          htmlStr = '<tr><td>Bytes</td><td>Description</td></tr><tr><td>20-24</td><td>Basic Display Parameter</td></tr>';
          $('#out_table_head_basidDisplayParameter').append(htmlStr);
          
          htmlStr = basicDisplayParameter(edidBuffer.slice(20, 25));
          $('#out_table_body_basidDisplayParameter').append(htmlStr);

        };
        // reader.readAsText(input.files[0]);
        reader.readAsArrayBuffer(input.files[0]);
      };
    </script>

    <!-- Simple Header Parser -->
    <script>

      // parse Header Information (bytes 0 ~ byte 19)
      var abccc = function(edid) {
        var buildStr = '';
        var manufacturerID = '';

        // manufacturer ID: big-endian 16-bit value made up of three 5-bit letters
        //          [8]       [9]
        //       0xxx xxyy yyyz zzzz
        // mask:    7    c    0    0
        //          0    3    E    0
        //          0    0    1    F
        manufacturerID += String.fromCharCode(((((edid[8] << 8) + edid[9]) & 0x7c00) >> 10) + 0x40);
        manufacturerID += String.fromCharCode(((((edid[8] << 8) + edid[9]) & 0x03E0) >> 5) + 0x40);
        manufacturerID += String.fromCharCode((edid[9] & 0x001F) + 0x40);
        
        if (edid[18] == 0x01 && edid[19] == 0x03)
          EDID_VERSION = '1.3';
        else if (edid[18] == 0x01 && edid[19] == 0x04)
          EDID_VERSION = '1.4';
        
        buildStr += '<tr><td> 0 -  7 </td><td>' + toHexString(edid.slice(0, 8), ' ') + '</td></tr>';
        buildStr += '<tr><td> 8 -  9 </td><td>' + manufacturerID + '</td></tr>';
        buildStr += '<tr><td>10 - 11 </td><td>' + toHexString(edid.slice(10, 12), ' ') + '</td></tr>';
        buildStr += '<tr><td>12 - 15 </td><td>' + toHexString(edid.slice(12, 16), ' ') + '</td></tr>';
        buildStr += '<tr><td>16 - 16 </td><td>' + toHexString(edid.slice(16, 17), ' ') + '</td></tr>';
        buildStr += '<tr><td>17 - 17 </td><td>' + toHexString(edid.slice(17, 18), ' ') + '</td></tr>';
        buildStr += '<tr><td>18 - 19 </td><td>' + toHexString(edid.slice(18, 20), ' ') + '</td></tr>';

        return buildStr;
      }
    </script>

    <script>
      function findAspectRatio(ratio) {
        if (ratio == 34)
          return "4:3";
        if (ratio == 79)
          return "16:9";
        else if (ratio = 61)
          return "16:10";
        else
          return "undefined";
      }
      // parse Basic Display Parameter (bytes 20 ~ byte 24)
      var basicDisplayParameter = function(edid) {
        var buildStr = '';
        
        // 14h
        var videoInputParameter = adr14h = edid[0];
        // display type is digital
        if (videoInputParameter & BIT7) {
          var bitDepth = '';
          var videoInterface = '';
          var bd = (videoInputParameter & (BIT6|BIT5|BIT4)) >> 4;
          var vi = (videoInputParameter & (BIT3|BIT2|BIT1|BIT0));

          if (bd == 0)
            bitDepth = 'undefined';
          else if (bd == 7)
            bitDepth = 'reserved';
          else
            bitDepth = 6 + 2*(bd-1);
            
          if (vi == 0)
            videoInterface = 'undefined';
          else if (vi == 1)
            videoInterface = 'DVI';
          else if (vi == 2)
            videoInterface = 'HDMI-a';
          else if (vi == 3)
            videoInterface = 'HDMI-b';
          else if (vi == 4)
            videoInterface = 'MDDI';
          else if (vi == 5)
            videoInterface = 'DisplayPort';
          else
            videoInterface = 'undefined';

          buildStr += '<tr><td> 20 - 20 </td><td>' + 'bit depth: ' + bitDepth + '</td></tr>';
        } else {
          // display type is analog
          var sl = (videoInputParameter & (BIT6|BIT5)) >> 5;
          var syncLevel = '';
          if (sl == 0)
            syncLevel = '+0.7/-0.3 V';
          else if (sl == 1)
            syncLevel = '+0.714/−0.286 V';
          else if (sl == 2)
            syncLevel = '+1.0/−0.4 V';
          else
            syncLevel = '+0.7/0 V';

          var videoSetup = '';
          if (videoInputParameter & BIT4)
            videoSetup = 'Video Setup: Blank-to-Black setup or pedestal';
          else
            videoSetup = 'Video Setup: Blank Level = Black Level';
            
          var synchronizationTypes = '';
          if (videoInputParameter & BIT3)
            synchronizationTypes = 'Separate Sync H & V Signals are supported';
          else
            synchronizationTypes = 'Separate Sync H & V Signals are not supported';
            
          if (videoInputParameter & BIT2)
            synchronizationTypes += 'Composite Sync Signal on Horizontal is supported';
          else
            synchronizationTypes += 'Composite Sync Signal on Horizontal is not supported';
            
          if (videoInputParameter & BIT1)
            synchronizationTypes += 'Composite Sync Signal on Green Video is supported';
          else
            synchronizationTypes += 'Composite Sync Signal on Green Video is not supported';

          var Serrations = '';
          if (videoInputParameter & BIT0)
            Serrations = 'Serration on the Vertical Sync is supported';
          else
            Serrations = 'Serration on the Vertical Sync is not supported';
            
          //return '<tr><td> 20 - 20 </td><td>' + syncLevel + videoSetup + synchronizationTypes + Serrations + '</td></tr>';
        }
        
        // 15h, 16h
        var adr15h = edid[1];
        var adr16h = edid[2];
        var sizeOrRatio = '';
        if (adr15h == 0 && adr16h == 0)
          sizeOrRatio = 'undefined';
        else if (adr16h != 0) {
          // cm
          sizeOrRatio = "screen size: " + adr15h + " x " + adr16h + " cm";
          //sizeOrRation = 
        } else {
          // ratio
          sizeOrRatio = "aspect ratio: " + findAspectRatio(ratio);
        }
        
        <!-- if 225, gamma is defined by DI-EXT block. -->
        // 17h
        var storedGamma = edid[3];
        var gamma = (storedGamma+100)/100;
        
        // 18h
        var adr18h = edid[4];
        if (adr18h & BIT7)
          buildStr += 'Standby Mode is supported.';
        else
          buildStr += 'Standby Mode is not supported.';
          
        if (adr18h & BIT6)
          buildStr += 'Suspend Mode is supported.';
        else
          buildStr += 'Suspend Mode is not supported.';
          
        if (adr18h & BIT5)
          buildStr += 'Active Off = Very Low Power is supported.';
        else
          buildStr += 'Active Off = Very Low Power is not supported.';
          
        var color = (adr18h & (BIT4|BIT3)) >> 3;
        if (adr14h & BIT7) {
          if (color == 0)
            buildStr += 'RGB 4:4:4';
          else if (color == 1)
            buildStr += 'RGB 4:4:4 & YCrCb 4:4:4';
          else if (color == 2)
            buildStr += 'RGB 4:4:4 & YCrCb 4:2:2';
          else {
            buildStr += 'RGB 4:4:4 & YCrCb 4:4:4 & YCrCb 4:2:2';
          }
        }else {
          if (color == 0)
            buildStr += 'Monochrome or Grayscale display';
          else if (color == 1)
            buildStr += 'RGB color display';
          else if (color == 2)
            buildStr += 'Non-RGB color display';
          else {
            buildStr += 'undefined';
          }
        }
        
        if (adr18h & BIT2)
          buildStr += 'sRGB Standard is the default color space.';
        else
          buildStr += 'sRGB Standard is not the default color space.';
          
        if (adr18h & BIT1)
          buildStr += 'Preferred timing mode specified in descriptor block 1.';
        else
          buildStr += 'No preferred timing?';
          
        if (EDID_VERSION === '1.3') {
          if (adr18h & BIT0)
            buildStr += 'support for GTF';
          else 
            buildStr += 'no support for GTF';  
        } else if (EDID_VERSION === '1.4') {
          if (adr18h & BIT0)
            buildStr += 'support for Continuous Frequency Display';
          else 
            buildStr += 'support for Non-Continuous Frequency (Multi-Mode) Display';  
        }
      }
    </script>

    <!-- common utils -->
    <script>
      const alpha = [ 'A', 'B', 'C', 'D', 'E',
      'F', 'G', 'H', 'I', 'J',
      'K', 'L', 'M', 'N', 'O',
      'P', 'Q', 'R', 'S', 'T',
      'U', 'V', 'W', 'X', 'Y', 'Z' ];

      // convert ArrayBuffer to HexString
      var buf2hex = function(buffer) { // buffer is an ArrayBuffer
        return Array.prototype.map.call(new Uint8Array(buffer), x => ('00' + x.toString(16)).slice(-2)).join('');
      }


      // hexchar to binarystring
      // sample:
      var hex2bin = function(hex) {
        return (parseInt(hex, 16).toString(2)).padStart(hex.length * 4, '0');
      }


      // binString to ascii
      var binaryToChar = function (binary) {
        return alpha[parseInt(binary, 2)];
      }
    </script>
  </head>
  <body>
    <table class="topazCells">
      <thead>
      <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td >0</td>
        <td id="data0">cell1_1</td>
        <td id="data1">cell2_1</td>
        <td id="data2">cell3_1</td>
        <td id="data3">cell4_1</td>
        <td id="data4">cell5_1</td>
        <td id="data5">cell6_1</td>
        <td id="data6">cell7_1</td>
        <td id="data7">cell8_1</td>
        <td id="data8">cell9_1</td>
        <td id="data9">cell10_1</td>
        <td id="data10">cell11_1</td>
        <td id="data11">cell12_1</td>
        <td id="data12">cell13_1</td>
        <td id="data13">cell14_1</td>
        <td id="data14">cell15_1</td>
        <td id="data15">cell16_1</td>
      </tr>
      <tr>
        <td>1</td>
        <td id="data16">cell1_2</td>
        <td id="data17">cell2_2</td>
        <td id="data18">cell3_2</td>
        <td id="data19">cell4_2</td>
        <td id="data20">cell5_2</td>
        <td id="data21">cell6_2</td>
        <td id="data22">cell7_2</td>
        <td id="data23">cell8_2</td>
        <td id="data24">cell9_2</td>
        <td id="data25">cell10_2</td>
        <td id="data26">cell11_2</td>
        <td id="data27">cell12_2</td>
        <td id="data28">cell13_2</td>
        <td id="data29">cell14_2</td>
        <td id="data30">cell15_2</td>
        <td id="data31">cell16_2</td>
      </tr>
      <tr>
        <td>2</td>
        <td id="data32">cell1_3</td>
        <td id="data33">cell2_3</td>
        <td id="data34">cell3_3</td>
        <td id="data35">cell4_3</td>
        <td id="data36">cell5_3</td>
        <td id="data37">cell6_3</td>
        <td id="data38">cell7_3</td>
        <td id="data39">cell8_3</td>
        <td id="data40">cell9_3</td>
        <td id="data41">cell10_3</td>
        <td id="data42">cell11_3</td>
        <td id="data43">cell12_3</td>
        <td id="data44">cell13_3</td>
        <td id="data45">cell14_3</td>
        <td id="data46">cell15_3</td>
        <td id="data47">cell16_3</td>
      </tr>
      <tr>
      <td>3</td>
        <td id="data48">cell1_4</td>
        <td id="data49">cell2_4</td>
        <td id="data50">cell3_4</td>
        <td id="data51">cell4_4</td>
        <td id="data52">cell5_4</td>
        <td id="data53">cell6_4</td>
        <td id="data54">cell7_4</td>
        <td id="data55">cell8_4</td>
        <td id="data56">cell9_4</td>
        <td id="data57">cell10_4</td>
        <td id="data58">cell11_4</td>
        <td id="data59">cell12_4</td>
        <td id="data60">cell13_4</td>
        <td id="data61">cell14_4</td>
        <td id="data62">cell15_4</td>
        <td id="data63">cell16_4</td>
      </tr>
      <tr>
      <td>4</td>
        <td id="data64">cell1_5</td>
        <td id="data65">cell2_5</td>
        <td id="data66">cell3_5</td>
        <td id="data67">cell4_5</td>
        <td id="data68">cell5_5</td>
        <td id="data69">cell6_5</td>
        <td id="data70">cell7_5</td>
        <td id="data71">cell8_5</td>
        <td id="data72">cell9_5</td>
        <td id="data73">cell10_5</td>
        <td id="data74">cell11_5</td>
        <td id="data75">cell12_5</td>
        <td id="data76">cell13_5</td>
        <td id="data77">cell14_5</td>
        <td id="data78">cell15_5</td>
        <td id="data79">cell16_5</td>
      </tr>
      <tr>
        <td>5</td>
        <td id="data80">cell1_6</td>
        <td id="data81">cell2_6</td>
        <td id="data82">cell3_6</td>
        <td id="data83">cell4_6</td>
        <td id="data84">cell5_6</td>
        <td id="data85">cell6_6</td>
        <td id="data86">cell7_6</td>
        <td id="data87">cell8_6</td>
        <td id="data88">cell9_6</td>
        <td id="data89">cell10_6</td>
        <td id="data90">cell11_6</td>
        <td id="data91">cell12_6</td>
        <td id="data92">cell13_6</td>
        <td id="data93">cell14_6</td>
        <td id="data94">cell15_6</td>
        <td id="data95">cell16_6</td>
      </tr>
      <tr>
      <td>6</td>
        <td id="data96">cell1_7</td>
        <td id="data97">cell2_7</td>
        <td id="data98">cell3_7</td>
        <td id="data99">cell4_7</td>
        <td id="data100">cell5_7</td>
        <td id="data101">cell6_7</td>
        <td id="data102">cell7_7</td>
        <td id="data103">cell8_7</td>
        <td id="data104">cell9_7</td>
        <td id="data105">cell10_7</td>
        <td id="data106">cell11_7</td>
        <td id="data107">cell12_7</td>
        <td id="data108">cell13_7</td>
        <td id="data109">cell14_7</td>
        <td id="data110">cell15_7</td>
        <td id="data111">cell16_7</td>
      </tr>
      <tr>
      <td>7</td>
        <td id="data112">cell1_8</td>
        <td id="data113">cell2_8</td>
        <td id="data114">cell3_8</td>
        <td id="data115">cell4_8</td>
        <td id="data116">cell5_8</td>
        <td id="data117">cell6_8</td>
        <td id="data118">cell7_8</td>
        <td id="data119">cell8_8</td>
        <td id="data120">cell9_8</td>
        <td id="data121">cell10_8</td>
        <td id="data122">cell11_8</td>
        <td id="data123">cell12_8</td>
        <td id="data124">cell13_8</td>
        <td id="data125">cell14_8</td>
        <td id="data126">cell15_8</td>
        <td id="data127">cell16_8</td>
      </tr>
      <tr>
      </tbody>
      </tr>
    </table>
    <input type="file" accept=".bin" onchange="openFile(event)" /><br />
    <div id="output"></div>
    <div id="out_table">
      <table>
        <thead id="out_table_head"></thead>
        <tbody id="out_table_body"></tbody>
        <thead id="out_table_head_basidDisplayParameter"></thead>
        <tbody id="out_table_body_basidDisplayParameter"></tbody>
      </table>
    </div>
  </body>
</html>
